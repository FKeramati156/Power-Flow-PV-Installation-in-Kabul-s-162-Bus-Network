sets
 i Number of Buses in System /1*162/
r /z1*z8/
z/1*5/

     slackbus(i) Number of SlackBus in System /4/

*PV(i) Number of PV_Buses in System  / if exist/
     PQ(i) Number of PQ_Buses in System  /4*162/
  LLoad(i)/4*162/
pvi(i)/16,22,25,30,46,53,59,60,65,66,69,70,71,81,83,86,87,96,99,100,102,104,106,108,117,119,126,132,133,162/
*pvi2(i)/4,5,6,7,9,10,18,19,20/
 s index for season of year /t/
*B-P,T,Z/
         ti index for time of day /1*15/
ttt/1*24/
t1(ttt)/1*5/
t2(ttt)/11,12,13/
t3(ttt)/20,21,22/
t4/23,24/
*24/
          w index for level of operation/1*4/


alias(i,j);



set Gen Number of Generation Units in System /g1/;
sets
zz1(i)/154,155,156,157,158,159,160,161,162/
zz2(i)/135,136,137,138,139,140,141,142,143,144,145,146,147,148,149,150,151,152,153/
zz3(i)/7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24/
zz4(i)/25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49/
zz5(i)/50,51,52,53,54,55,56,57,58,59,60,61,62,63,64/
zz6(i)/69,70,71,72,73,74,75,76,77,78,79,80,81,82,83,84,85,86,87/
zz7(i)/5,6,90,89,92,133,134,107,108,109,110,111,112,113,114,115,119,128,126,127,120,124,121,122,123/
zz8(i)/106,104,103,105,102,101,100,99,98,97,96,95,94,93,91,88,129,130,131,132,65,66,67,68,116,117,118,125/

;
parameter
c_fix fix costof location cs ($) / 163000/
cs_p cost for one charge point /20907.44/

scalar sbase/100/;

Table GenD(Gen,*) 'generating units characteristics'
         Pg      Qg      Pmax     Pmin    Qmax    Qmin
g1       0        0      1000        0     100     -100 ;


Set GBconect(i,Gen) 'connectivity index of each generating unit to each bus'

/4.g1/;

parameters
pd
qd;
parameter


Table BD(i,*) 'demands of each bus in MW and MVar'
                 pd              qd

4                0               0
5               0.5355          0.229229
6               0.5355          0.229229
7               0.5355          0.229229
8               0.2125          0.090964
9               0.5355          0.229229
10              0.5355          0.229229
11              0.34            0.145542
12              0.34            0.145542
13              0.34            0.145542
14              0.85            0.363856
15              0.5355          0.229229
16              0.5355          0.229229
17              0.2125          0.090964
18              0.5355          0.229229
19              0.5355          0.229229
20              0.68            0.291085
21              0.2125          0.090964
22              0.5355          0.229229
23              1.625           0.45482
24              1.625           0.45482
25              0.85            0.363856
26              0.68            0.291085
27              0.17            0.072771
28              0.68            0.291085
29              0.34            0.145542
30              0.34            0.145542
31              0.34            0.145542
32              0.5355          0.229229
33              2.125           0.909639
34              2.125           0.909639

35              0.5355          0.229229
36              0.5355          0.229229
37              0.5355          0.229229
38              0.34            0.145542
39              0.68            0.291085
40              0.5355          0.229229

41              0.5355          0.229229
42              0.34            0.145542
43              0.2125          0.090964
44              0.85            0.363856
45              0.2125          0.090964
46              0.2125          0.090964
47              0.2125          0.090964
48              0.5355          0.229229
49              0.34            0.145542
50              0.34            0.145542


51              0.68            0.291085
52              0.34            0.145542
53              0.68            0.291085
54              0.5355          0.229229
55              0.5355          0.229229
56              0.5355          0.229229
57              0.34            0.145542
58              0.34            0.145542
59              0.85            0.363856
60              0.34            0.145542

61              0.85            0.363856
62              0.85            0.363856
63              0.68            0.291085
64              0.68            0.291085
65              0.34            0.145542
66              0.5355          0.229229
67              0.34            0.145542
68              0.85            0.363856
69              0.5355          0.229229
70              0.34            0.145542
71              0.2125          0.090964
72              0.17            0.072771
73              0.26775         0.114615
74              0.34            0.145542
75              0.34            0.145542
76              0.34            0.145542
77              0.5355          0.229229
78              0.5355          0.229229
79              0.5355          0.229229
80              0.34            0.145542
81              0.85            0.363856
82              0.17            0.072771
83              0.34            0.145542
84              0.5355          0.229229
85              0.2125          0.090964
86              0.17            0.072771
87              0.34            0.145542
88              0.5355          0.229229
89              0.34            0.145542
90              0.68            0.291085

91              0.17            0.072771
92              0.34            0.145542
93              0.34            0.145542
94              0.5355          0.229229
95              0.5355          0.229229
96              0.2125          0.090964
97              0.2125          0.090964
98              0.34            0.145542
99              0.2125          0.090964
100             0.5355          0.229229

101             0.34            0.145542

102             0.5355          0.229229
103             0.34            0.145542
104             0.2125          0.090964
105             0.5355          0.229229

106             0.85            0.363856
107             0.5355          0.229229
108             0.5355          0.229229
109             0.85            0.363856
110             0.5355          0.229229

111             0.5355          0.229229
112             0.5355          0.229229
113             0.34            0.145542
114             0.5355          0.229229

115             0.5355          0.229229
116             0.5355          0.229229
117             0.85            0.363856
118             0.85            0.363856
119             0.5355          0.229229
120             0.85            0.363856


121             0.5355          0.229229
122             0.136           0.058217
123             0.085           0.036386
124             0.34            0.145542
125             0.34            0.145542
126             0.5355          0.229229
127             0.34            0.145542
128             0.85            0.363856
129             0.34            0.145542
130             0.34            0.145542

131             0.34            0.145542
132             0.34            0.145542
133             1.071           0.458458
134             0.5355          0.229229
135             0.5355          0.229229
136             0.5355          0.229229
137             0.5355          0.229229
138             0.68            0.291085
139             0.68            0.291085
140             0.34            0.145542

141             0.2125          0.090964
142             0.85            0.363856
143             0.34            0.145542
144             0.2125          0.090964
145             0.2125          0.090964
146             0.2125          0.090964
147             0.68            0.291085
148             0.5355          0.229229
149             0.34            0.145542
150             0.2125          0.090964

151             0.2125          0.090964
152             0.2125          0.090964
153             0.0425          0.018193
154             0.2125          0.090964
155             0.2125          0.090964
156             0.2125          0.090964
157             0.34            0.145542
158             0.68            0.291085
159             0.34            0.145542
160             0.2125          0.090964
161             0.34            0.145542
162             0.34            0.145542  ;



table co_p(s,ti) coeffiecent for active power
       1         2       3       4       5       6       7        8        9        10       11      12      13      14     15
*       16      17      18        19      20      21      22      23      24
T      0.6      0.65    0.65    0.65    0.65    0.65    0.65     0.65     0.7      0.65    0.65    0.75      0.8     0.75   0.6

*       0.6     0.6     0.6      0.6      0.6   0.65    0.65     0.65     0.65     0.65     0.65    0.65    0.65    0.65   0.7
*     0.65    0.65    0.75      0.8     0.75    0.75    0.75    0.6     0.6
;

table co_price(s,ti) coeffiecent for price of electricity
       1    2       3       4       5    6       7       8       9        10     11      12      13      14      15
*    16      17      18       19      20      21      22      23      24
T      60  60      60      60      60    90      90      90      90       90     120     120     120     120     120
*     80      80      80       80      80      70      70      70      70
  ;




Table   branch(i,j,*)  in pu
                r               x
4.5           0.0276           0.0036
5.6           0.1923           0.0252
4.7           0.0783           0.0066
7.8           0.0234           0.0021
7.9           0.1923           0.0252
4.10          0.0276           0.0036
10.11         0.0687           0.009
10.12         0.0714           0.0093
10.13         0.0825           0.0108
10.14         0.1098           0.0144
10.15         0.1098           0.0144
10.16         0.0276           0.0036
16.17         0.0714           0.0093
16.18         0.0192           0.0024
18.19         0.1098           0.0144
16.20         0.1236           0.0162
16.21         0.1374           0.018
16.22         0.1344           0.0177
16.23         0.0195           0.0018
23.24         0.0495           0.0066
4.25          0.0549           0.0072
25.26         0.1176           0.0102
26.27         0.0393           0.0033
27.28         0.0588           0.0051
28.29         0.0588           0.0051
27.30         0.0393           0.0033
30.31         0.1569           0.0135
31.32         0.1569           0.0135
30.33         0.1236           0.0162
33.34         0.0393           0.0033

4.35          0.0393           0.0033
35.36         0.0687           0.009
36.37         0.0219           0.003
37.38         0.3294           0.0432
37.39         0.0234           0.0021
39.40         0.1647           0.0216

40.41         0.0471           0.0039
39.42         0.0156           0.0012
39.43         0.0438           0.0057
39.44         0.0507           0.0066
39.45         0.0276           0.0036
4.46          0.0138           0.0018
46.47         0.0603           0.0078
46.48         0.0195           0.0018
48.49         0.1536           0.0201
4.50          0.0468           0.006


50.51         0.1647           0.0216
51.52         0.588            0.0504
51.53         0.0393           0.0033
51.54         0.0393           0.0033
54.55         0.0627           0.0054
55.56         0.0783           0.0066
56.57         0.0234           0.0021
54.58         0.0255           0.0021
58.59         0.0273           0.0024
58.60         0.0687           0.006

62.61         0.0156           0.0012
62.60         0.0117           0.0009

62.63         0.0234           0.0021
63.64         0.0195           0.0018
4.65          0.0273           0.0024
65.66         0.0195           0.0018
66.67         0.4119           0.054
65.68         0.0825           0.0108
68.69         0.0276           0.0036
69.70         0.0357           0.0048
70.71         0.0276           0.0036
71.72         0.0276           0.0036
70.73         0.096            0.0126
73.74         0.0411           0.0054
73.75         0.1569           0.0135
75.76         0.0234           0.0021
76.77         0.0393           0.0033
73.78         0.0393           0.0033
78.79         0.0393           0.0033
78.80         0.0627           0.0054
80.81         0.0354           0.003
81.82         0.0549           0.0048
80.83         0.0471           0.0039
83.84         0.0234           0.0021
84.85         0.0549           0.0048
85.86         0.051            0.0045
85.87         0.1764           0.015
4.88          0.0471           0.0039
88.89         0.0471           0.0039
89.90         0.1647           0.0216

88.91         0.0783           0.0066
88.92         0.0315           0.0027
88.93         0.0411           0.0054
88.94         0.0549           0.0072
94.95         0.0687           0.009
94.96         0.096            0.0125
96.97         0.0603           0.0078
94.98         0.0393           0.00333
94.99         0.0294           0.0024
101.100       0.1371           0.0117
101.99        0.1371           0.0117

101.102       0.0276           0.0036
102.103       0.0195           0.0018
103.104       0.0276           0.0036
104.105       0.0165           0.0021

104.106       0.096            0.0126
106.107       0.0195           0.0018
106.108       0.0687           0.009
108.109       0.0627           0.0054
109.110       0.0234           0.003

109.111       0.0276           0.0036
111.112       0.0165           0.0021
112.113       0.0276           0.0036
113.114       0.0276           0.0036

108.115       0.0276           0.0036
108.116       0.0276           0.0036
108.117       0.0195           0.0018
117.118       0.0393           0.0033
108.119       0.0558           0.0036
4.120         0.0588           0.0051

120.121       0.0783           0.0066
120.122       0.2334           0.0306
120.123       0.0195           0.0018
120.124       0.0207           0.0027
120.125       0.0207           0.0027
120.126       0.0315           0.0027
126.127       0.0411           0.0054
120.128       0.0219           0.003
4.129         0.0195           0.0018
129.130       0.0411           0.0054

130.131       0.0627           0.0054
131.132       0.2472           0.0324
4.133         0.0138           0.0018
133.134       0.2058           0.027
4.135         0.276            0.0036
135.136       0.4941           0.0648
136.137       0.0471           0.0039
135.138       0.1305           0.0324
138.139       0.0117           0.0009
138.140       0.0195           0.0018

138.141       0.0507           0.0126
138.142       0.1317           0.0171
138.143       0.0687           0.009
138.144       0.2058           0.027
138.145       0.2196           0.0288
138.146       0.1923           0.0252
138.147       0.0687           0.009
147.148       0.0276           0.0036
147.149       0.0687           0.009
138.150       0.0549           0.0072
138.151       0.0195           0.0018
138.152       0.234            0.0021
138.153       0.1098           0.0144
138.154       0.0768           0.0102
138.155       0.02276          0.0036
138.156       0.0411           0.0054
138.157       0.033            0.0042
138.158       0.0495           0.0066
138.159       0.0603           0.0078
138.160       0.0825           0.0108
138.161       0.1236           0.0162
138.162       0.096            0.0126


;
parameter
c_wait(i,w);

c_wait(i,'1')=1;
c_wait(i,'2')=1.5;
c_wait(i,'3')=3;
c_wait(i,'4')=4;

Set line(i,j)  Dist_line/4.5,5.6,4.7,7.8,7.9,4.10,10.11,10.12,10.13,10.14,10.15,10.16,16.17,16.18,18.19,16.20,16.21,16.22,16.23,23.24,4.25,25.26,26.27,27.28,28.29,
27.30,30.31,31.32,30.33,33.34,4.35,35.36,36.37,37.38,37.39,39.40,40.41,39.42,39.43,39.44,39.45,4.46,46.47,46.48,48.49,4.50,50.51,51.52,51.53,51.54,54.55,55.56,
56.57,54.58,58.59,58.60,62.61,62.60,62.63,63.64,4.65,65.66,66.67,65.68,68.69,69.70,70.71,71.72,70.73,73.74,73.75,75.76,76.77,73.78,78.79,78.80,80.81,81.82,80.83,
83.84,84.85,85.86,85.87,4.88,88.89,89.90,88.91,88.92,88.93,88.94,94.95,94.96,96.97,94.98,94.99,101.100,101.99,101.102,102.103,103.104,104.105,104.106,106.107,
106.108,108.109,109.110,109.111,111.112,112.113,113.114,108.115,108.116,108.117,117.118,108.119,4.120,120.121,120.122,120.123,120.124,120.125,120.126,126.127,
120.128,4.129,129.130,130.131,131.132,4.133,133.134,4.135,135.136,136.137,135.138,138.139,138.140,138.141,138.142,138.143,138.144,138.145,138.146,138.147,147.148,
147.149,138.150 ,138.151,138.152,138.153,138.154,138.155,138.156,138.157,138.158,138.159,138.160,138.161,138.162/ ;



parameter
b
g
d_

c_d(ti)/1 0.01,2 0.01,3 0.01,4 0.01,5 0.01,6 0.06,7 0.06,8 0.06,9 0.06,10 0.06,11 0.07,12 0.07,13 0.07,14 0.07,15 0.07/
*,16 0.09,17 0.09,18 0.09,19 0.03,20 0.03,21 0.03,22 0.03,23 0.03,24 0.03/  ;

parameter
TR(r,i)
d;
d(r)=150;
TR('z1',i)$zz1(i)=5;
TR('z1',i)$zz2(i)=10;
TR('z1',i)$zz3(i)=10;
TR('z1',i)$zz4(i)=12;
TR('z1',i)$zz5(i)=15;
TR('z1',i)$zz6(i)=20;
TR('z1',i)$zz7(i)=12;
TR('z1',i)$zz8(i)=20;
***
TR('z2',i)$zz1(i)=10;
TR('z2',i)$zz2(i)=5;
TR('z2',i)$zz3(i)=10;
TR('z2',i)$zz4(i)=10;
TR('z2',i)$zz5(i)=10;
TR('z2',i)$zz6(i)=15;
TR('z2',i)$zz7(i)=10;
TR('z2',i)$zz8(i)=15;
***
TR('z3',i)$zz1(i)=10;
TR('z3',i)$zz2(i)=10;
TR('z3',i)$zz3(i)=5;
TR('z3',i)$zz4(i)=10;
TR('z3',i)$zz5(i)=12;
TR('z3',i)$zz6(i)=20;
TR('z3',i)$zz7(i)=15;
TR('z3',i)$zz8(i)=20;
***
TR('z4',i)$zz1(i)=12;
TR('z4',i)$zz2(i)=10;
TR('z4',i)$zz3(i)=10;
TR('z4',i)$zz4(i)=5;
TR('z4',i)$zz5(i)=10;
TR('z4',i)$zz6(i)=15;
TR('z4',i)$zz7(i)=12;
TR('z4',i)$zz8(i)=20;
***
TR('z5',i)$zz1(i)=15;
TR('z5',i)$zz2(i)=10;
TR('z5',i)$zz3(i)=12;
TR('z5',i)$zz4(i)=10;
TR('z5',i)$zz5(i)=5;
TR('z5',i)$zz6(i)=10;
TR('z5',i)$zz7(i)=10;
TR('z5',i)$zz8(i)=12;
***
TR('z6',i)$zz1(i)=20;
TR('z6',i)$zz2(i)=15;
TR('z6',i)$zz3(i)=20;
TR('z6',i)$zz4(i)=15;
TR('z6',i)$zz5(i)=10;
TR('z6',i)$zz6(i)=5;
TR('z6',i)$zz7(i)=12;
TR('z6',i)$zz8(i)=10;
***
TR('z7',i)$zz1(i)=12;
TR('z7',i)$zz2(i)=10;
TR('z7',i)$zz3(i)=15;
TR('z7',i)$zz4(i)=12;
TR('z7',i)$zz5(i)=10;
TR('z7',i)$zz6(i)=12;
TR('z7',i)$zz7(i)=5;
TR('z7',i)$zz8(i)=10;
***
TR('z8',i)$zz1(i)=20;
TR('z8',i)$zz2(i)=15;
TR('z8',i)$zz3(i)=20;
TR('z8',i)$zz4(i)=20;
TR('z8',i)$zz5(i)=12;
TR('z8',i)$zz6(i)=10;
TR('z8',i)$zz7(i)=10;
TR('z8',i)$zz8(i)=5;

D_(r,ti)=d(r)*c_d(ti);
****************&&&&&&&&&&&&&&&&&&&
set
dg/pv,wt/
;
parameters
cww/10000/
vc_i  cut_in/3/
vc_o cut_out /25/
v_r rated velovity/15/

h_c
sv
wt_max maximum power w-t 0.5mw/0.01/
pv_mx (i) maximum power p.u /16 450,22 225,25 525,30 600,46 450,53 600,59 225,60 450,65 225,66 600,69 300,70 450,71 150
,81 150,83 450,86 150,87 450,96 450,99 450,100 300,102 300,104 450,106 375,108 375,117 450,119 150,126 525,132 225,133 240,162 525/

mas(i)/16 3000,22 1500,25 3500,30 4000,46 3000,53 4000,59 1500,60 3000,65 1500,66 4000,69 2000,70 3000,71 1000,81 1000,83 3000,
86 1000,87 3000,96 3000,99 3000,100 2000,102 2000,104 3000,106 2500,108 2500,117 3000,119 1000,126 3500,132 1500,133 1600,162 3500/


table co_pv(s,ti) radition sun kw-m2
        1 2       3       4       5       6       7       8       9        10      11      12      13      14      15
*     16      17      18       19      20      21      22      23      24
*winter  0        0       0       0       0       0     0.1      0.2     0.35      0.5     0.58    0.6    0.6     0.58    0.57    0.55    0.3     0.12      0       0       0       0       0       0                                                              0      0       0       0       0       0
t       0 0       0       0       0      0.1    0.25     0.35    0.55      0.8     0.82    0.82   0.82    0.8     0.7
*    0.55    0.3     0.12      0       0       0       0       0       0;
;
*table h_c(dg,k) harmonic current factor
*         1     2        3       4        5       6        7       8       9       10      11
*pv       1     0.011    0.032   0.0026   0.034   0.0012   0.011   0.008   0.0004   0.008   0.006
*wt       1     0.011    0.032   0.0026   0.034   0.0012   0.011   0.008   0.0004   0.008   0.006;

sv(i)=pv_mx (i)*1.1 ;
*&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&

positive variable pwind,pv,sst
positive variable fr
positive variable landa
binary variable xs
*integer variable y
*binary variable
positive variable bw,bp

variable
V
theta
Pg
Qg
Pfrom
Qfrom
Ploss
edummy
pst
qst
pst
qv
gg
cost
qstt
ssst;



equations
eq1
eq2
eq3
eq4
eq5
eq6
*eq7
eq8
e1
*e2
e3
e4
c1
c2
;

parameter
c_instal
c_travel
c_waitt
c_equip
penalty_cost

co_pp
plosss
c_p
c_q

;
set
f/1*10/;
parameter
cus(f)/1 3,2 7.2,3 12.6,4 19.2,5 27,6 36,7 46.2,8 57,9 69,10 82.2/
;
parameter pstt;
pstt(ti)= (round(200*c_d(ti))*0.15*100)/100000  ;
b(i,j)$(line(i,j))= -branch(i,j,'x')/(sqr(branch(i,j,'r'))+sqr(branch(i,j,'x')));
g(i,j)$(line(i,j))= branch(i,j,'r')/(sqr(branch(i,j,'r'))+sqr(branch(i,j,'x')));
pd(i,ti)=BD(i,'pd') *co_p('t',ti);
qd(i,ti)=BD(i,'qd') *co_p('t',ti);
co_pp(ti) =co_price('t',ti);
***********************************objective function
eq8.. edummy=e=10000*sum((i,ti),1-v(i,ti))+sum(ti,0.06*sbase*10000*ploss(ti))+0.01*sum(i,mas(i)*bp(i)*75);

*************************************PowerFlowEquations*************************************************

eq1(i,ti)..         sum(Gen$GBconect(i,Gen), Pg(Gen,ti))-pstt(ti)*xs(i)$lload(i)-pd(i,ti)/sbase-sum(line(i,j),Pfrom(i,j,ti))-sum(line(j,i),Pfrom(i,j,ti))=e=0;
*+pv(i,ti)+pwind(i,ti)
eq2(i,ti)..         sum(Gen$GBconect(i,Gen), Qg(Gen,ti))+qstt(i,ti)*xs(i)-qd(i,ti)/sbase-sum(line(i,j),Qfrom(i,j,ti))-sum(line(j,i),Qfrom(i,j,ti))=e=0;

c1(i,ti)$LLoad(i)                                ..sqrt(sqr(pstt(ti)*xs(i))+sqr(qstt(i,ti)))=l=(ssst(i))*xs(i);
c2..    sum(i,xs(i))=e=1;
**************************************LineFlowConstraints***********************************************

eq3(i,j,ti)$(line(i,j))..               Pfrom(i,j,ti)=e=(power(V(i,ti),2)*g(i,j)-V(i,ti)*V(j,ti)*[g(i,j)*1+b(i,j)*(theta(i,ti)-theta(j,ti))]);


eq4(i,j,ti)$(line(i,j))..               Pfrom(j,i,ti)=e=(power(V(j,ti),2)*g(i,j)-V(i,ti)*V(j,ti)*[g(i,j)*1-b(i,j)*(theta(i,ti)-theta(j,ti))]);


eq5(i,j,ti)$(line(i,j))..               Qfrom(i,j,ti)=e=(-power(V(i,ti),2)*(branch(i,j,'b')/2+b(i,j))-V(i,ti)*V(j,ti)*[g(i,j)*(theta(i,ti)-theta(j,ti))-b(i,j)*1]);


eq6(i,j,ti)$(line(i,j))..               Qfrom(j,i,ti)=e=(-power(V(j,ti),2)*(branch(i,j,'b')/2+b(i,j))+V(i,ti)*V(j,ti)*[g(i,j)*(theta(i,ti)-theta(j,ti))+b(i,j)*1]);

**************************************************************************************************************
*e1(i,ti)$lload(i)                                     ..pwind(i,ti)=l=p_wind(ti)*bw(i);

*e2..                                        sum(i,bw(i))=e=1;
e1(ti)..                Ploss(ti)=e=0.5*(sum(line(i,j),g(i,j)*[sqr(V(i,ti))+sqr(V(j,ti))-2*V(i,ti)*V(j,ti)*1]));

*eq8..                edummy=e=sum((i,ti),1-v(i,ti))+sum(ti,ploss(ti));
*s1(i,ti)..          gg(i,ti)=e=round(pst(i,ti)*1000) ;
*s2(i,ti)..                cost(i,ti)=e=sum(f$(ord(gg)),gg(i,ti)*cus(f)) ;

e3(i,ti)$pvi(i)                                    ..pv(i,ti)=l=mas(i)*co_pv('t',ti)*bp(i)/(sbase*1000);
*e2..  pv(i,ti)=l=pv_capacity(i) *bp(i)
e4..                                        sum(i$pvi(i),bp(i))=e=0;

*eq7(ti)..                Ploss(ti)=e=0.5*(sum(line(i,j),g(i,j)*[sqr(V(i,ti))+sqr(V(j,ti))-2*V(i,ti)*V(j,ti)*cos(theta(i,ti)-theta(j,ti))]));
*****************************************************
V.lo(i,ti)=0.85;

V.up(i,ti)=1.05;

pv.up(i,ti)=pv_mx (i)/(sbase*1000);
pv.lo(i,ti)=0;
*qst.up(i,ti)=0;

*V.fx('1',ti)=1;

Pg.lo(Gen,ti) = GenD(Gen,'Pmin')/sbase;
Pg.up(Gen,ti) = GenD(Gen,'Pmax')/sbase;

Qg.lo(Gen,ti) = GenD(Gen,'Qmin')/sbase;
Qg.up(Gen,ti) = GenD(Gen,'Qmax')/sbase;

model Rec/all/
*eq8,eq1,eq2,eq3,eq4,eq5,eq6,e1,e3,e4/
*,e1/
*,e1,e3,e4,co9,co10/


option reslim=1000800;

option minlp=baron;
option optca=0.1,optcr=0.1;

solve Rec using minlp minimizing edummy;
parameter
c_instal_pv
ploss_asli(ttt)
v_asli
pv_asli
pg_asli
qg_asli;
parameter c_qst,yy,pst_r
c_instal
c_equip
;

yy(i)=round(pstt('16')*xs.l(i)*100000/60);
c_qst=sum((i,ti),sbase*0.15*120*qstt.l(i,ti) ) ;
pst_r(i,ti)= pstt(ti)*xs.l(i);
*********************************
c_instal= sum(i,163000*xs.l(i)+20907*yy(i));

c_equip=sum((i )$lload(i),63220*Sbase*sqrt(ssst.l(i))*xs.l(i));
*********************************
c_instal_pv=sum(i,mas(i)*bp.l(i)*75);

plosss(ti)=0.5*(sum(line(i,j),g(i,j)*[sqr(V.l(i,ti))+sqr(V.l(j,ti))-2*V.l(i,ti)*V.l(j,ti)*cos(theta.l(i,ti)-theta.l(j,ti))]));

*************************Timimg*******************
ploss_asli(ttt)$t1(ttt)=0.5*(sum(line(i,j),g(i,j)*[sqr(V.l(i,'1'))+sqr(V.l(j,'1'))-2*V.l(i,'1')*V.l(j,'1')*cos(theta.l(i,'1')-theta.l(j,'1'))]));
ploss_asli('6')=0.5*(sum(line(i,j),g(i,j)*[sqr(V.l(i,'2'))+sqr(V.l(j,'2'))-2*V.l(i,'2')*V.l(j,'2')*cos(theta.l(i,'2')-theta.l(j,'2'))]));
ploss_asli('7')= 0.5*(sum(line(i,j),g(i,j)*[sqr(V.l(i,'3'))+sqr(V.l(j,'3'))-2*V.l(i,'3')*V.l(j,'3')*cos(theta.l(i,'3')-theta.l(j,'3'))]));

ploss_asli('8')=0.5*(sum(line(i,j),g(i,j)*[sqr(V.l(i,'4'))+sqr(V.l(j,'4'))-2*V.l(i,'4')*V.l(j,'4')*cos(theta.l(i,'4')-theta.l(j,'4'))]));

ploss_asli('9')=0.5*(sum(line(i,j),g(i,j)*[sqr(V.l(i,'5'))+sqr(V.l(j,'5'))-2*V.l(i,'5')*V.l(j,'5')*cos(theta.l(i,'5')-theta.l(j,'5'))]));

ploss_asli('10')=0.5*(sum(line(i,j),g(i,j)*[sqr(V.l(i,'6'))+sqr(V.l(j,'6'))-2*V.l(i,'6')*V.l(j,'6')*cos(theta.l(i,'6')-theta.l(j,'6'))]));
ploss_asli(ttt)$t2(ttt)=0.5*(sum(line(i,j),g(i,j)*[sqr(V.l(i,'7'))+sqr(V.l(j,'7'))-2*V.l(i,'7')*V.l(j,'7')*cos(theta.l(i,'7')-theta.l(j,'7'))]));
ploss_asli('14')=0.5*(sum(line(i,j),g(i,j)*[sqr(V.l(i,'8'))+sqr(V.l(j,'8'))-2*V.l(i,'8')*V.l(j,'8')*cos(theta.l(i,'8')-theta.l(j,'8'))]));

ploss_asli('15')=0.5*(sum(line(i,j),g(i,j)*[sqr(V.l(i,'9'))+sqr(V.l(j,'9'))-2*V.l(i,'9')*V.l(j,'9')*cos(theta.l(i,'9')-theta.l(j,'9'))]));

ploss_asli('16')=0.5*(sum(line(i,j),g(i,j)*[sqr(V.l(i,'10'))+sqr(V.l(j,'10'))-2*V.l(i,'10')*V.l(j,'10')*cos(theta.l(i,'10')-theta.l(j,'10'))]));

ploss_asli('17')=0.5*(sum(line(i,j),g(i,j)*[sqr(V.l(i,'11'))+sqr(V.l(j,'11'))-2*V.l(i,'11')*V.l(j,'11')*cos(theta.l(i,'11')-theta.l(j,'11'))]));

ploss_asli('18')= 0.5*(sum(line(i,j),g(i,j)*[sqr(V.l(i,'12'))+sqr(V.l(j,'12'))-2*V.l(i,'12')*V.l(j,'12')*cos(theta.l(i,'12')-theta.l(j,'12'))]));
ploss_asli('19')= 0.5*(sum(line(i,j),g(i,j)*[sqr(V.l(i,'13'))+sqr(V.l(j,'13'))-2*V.l(i,'13')*V.l(j,'13')*cos(theta.l(i,'13')-theta.l(j,'13'))]));

ploss_asli(ttt)$t3(ttt)=0.5*(sum(line(i,j),g(i,j)*[sqr(V.l(i,'14'))+sqr(V.l(j,'14'))-2*V.l(i,'14')*V.l(j,'14')*cos(theta.l(i,'14')-theta.l(j,'14'))]));
ploss_asli(ttt)$t4(ttt)=0.5*(sum(line(i,j),g(i,j)*[sqr(V.l(i,'15'))+sqr(V.l(j,'15'))-2*V.l(i,'15')*V.l(j,'15')*cos(theta.l(i,'15')-theta.l(j,'15'))]));
***********************************************************************************************************************

v_asli(i,ttt)$t1(ttt)=V.l(i,'1');
v_asli(i,'6')=V.l(i,'2');
v_asli(i,'7')=V.l(i,'3');
v_asli(i,'8')=V.l(i,'4');
v_asli(i,'9')=V.l(i,'5');
v_asli(i,'10')=V.l(i,'6');
v_asli(i,ttt)$t2(ttt)=V.l(i,'7');
v_asli(i,'14')=V.l(i,'8');
v_asli(i,'15')=V.l(i,'9');
v_asli(i,'16')=V.l(i,'10');
v_asli(i,'17')=V.l(i,'11');
v_asli(i,'18')=V.l(i,'12');
v_asli(i,'19')=V.l(i,'13');
v_asli(i,ttt)$t3(ttt)=V.l(i,'14');
v_asli(i,ttt)$t4(ttt)=V.l(i,'15');
***************************

pv_asli(i,ttt)$t1(ttt)=pV.l(i,'1');
pv_asli(i,'6')=pV.l(i,'2');
pv_asli(i,'7')=pV.l(i,'3');
pv_asli(i,'8')=pV.l(i,'4');
pv_asli(i,'9')=pV.l(i,'5');
pv_asli(i,'10')=pV.l(i,'6');
pv_asli(i,ttt)$t2(ttt)=pV.l(i,'7');
pv_asli(i,'14')=pV.l(i,'8');
pv_asli(i,'15')=pV.l(i,'9');
pv_asli(i,'16')=pV.l(i,'10');
pv_asli(i,'17')=pV.l(i,'11');
pv_asli(i,'18')=pV.l(i,'12');
pv_asli(i,'19')=pV.l(i,'13');
pv_asli(i,ttt)$t3(ttt)=pV.l(i,'14');
pv_asli(i,ttt)$t4(ttt)=pV.l(i,'15');
*************

pg_asli(gen,ttt)$t1(ttt)=pg.l(gen,'1');
pg_asli(gen,'6')=pg.l(gen,'2');
pg_asli(gen,'7')=pg.l(gen,'3');
pg_asli(gen,'8')=pg.l(gen,'4');
pg_asli(gen,'9')=pg.l(gen,'5');
pg_asli(gen,'10')=pg.l(gen,'6');
pg_asli(gen,ttt)$t2(ttt)=pg.l(gen,'7');
pg_asli(gen,'14')=pg.l(gen,'8');
pg_asli(gen,'15')=pg.l(gen,'9');
pg_asli(gen,'16')=pg.l(gen,'10');
pg_asli(gen,'17')=pg.l(gen,'11');
pg_asli(gen,'18')=pg.l(gen,'12');
pg_asli(gen,'19')=pg.l(gen,'13');
pg_asli(gen,ttt)$t3(ttt)=pg.l(gen,'14');
pg_asli(gen,ttt)$t4(ttt)=pg.l(gen,'15');
*************

qg_asli(gen,ttt)$t1(ttt)=qg.l(gen,'1');
qg_asli(gen,'6')=qg.l(gen,'2');
qg_asli(gen,'7')=qg.l(gen,'3');
qg_asli(gen,'8')=qg.l(gen,'4');
qg_asli(gen,'9')=qg.l(gen,'5');
qg_asli(gen,'10')=qg.l(gen,'6');
qg_asli(gen,ttt)$t2(ttt)=qg.l(gen,'7');
qg_asli(gen,'14')=qg.l(gen,'8');
qg_asli(gen,'15')=qg.l(gen,'9');
qg_asli(gen,'16')=qg.l(gen,'10');
qg_asli(gen,'17')=qg.l(gen,'11');
qg_asli(gen,'18')=qg.l(gen,'12');
qg_asli(gen,'19')=qg.l(gen,'13');
qg_asli(gen,ttt)$t3(ttt)=qg.l(gen,'14');
qg_asli(gen,ttt)$t4(ttt)=qg.l(gen,'15');
******************************************************************************************************************************

penalty_cost=1000*sum((i,ti),1-v.l(i,ti))+sum(ti,0.06*sbase*1000*ploss.l(ti));

c_p=sum((i,gen,ti),120*sbase*pg.l(gen,ti)) ;
c_q=sum((i,gen,ti),0.15*sbase*120*qg.l(gen,ti) ) ;

****************888

display c_instal_pv,v.l,pg.l,qg.l,plosss,penalty_cost,c_p,c_p,pv.l,bp.l,ploss_asli,v_asli,pg_asli,pv_asli;

* v.l,pg.l,qg.l,ploss.l,bw.l,bp.l,pwind.l,pv.l;
execute_unload "results_pv_162.gdx" pg_asli
execute 'gdxxrw.exe results_pv_162.gdx par=pg_asli rng=classic1!'
execute_unload "results_pv_162.gdx" qg_asli
execute 'gdxxrw.exe results_pv_162.gdx par=qg_asli rng=classic2!'
execute_unload "results_pv_162.gdx" v_asli
execute 'gdxxrw.exe results_pv_162.gdx par=v_asli rng=classic3!'
execute_unload "results_pv_162.gdx" ploss_asli
execute 'gdxxrw.exe results_pv_162.gdx par=ploss_asli rng=classic4!'
execute_unload "results_pv_162.gdx" pstt
execute 'gdxxrw.exe results_pv_162.gdx par=pstt rng=classic5!'
execute_unload "results_pv_162.gdx" qstt
execute 'gdxxrw.exe results_pv_162.gdx var=qstt rng=classic6!'
execute_unload "results_pv_162.gdx" ssst
execute 'gdxxrw.exe results_pv_162.gdx var=ssst rng=classic7!'